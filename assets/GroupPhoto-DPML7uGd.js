import{r as a,o as t,b as e,w as o,H as l,K as s,J as r,S as i,U as n,k as u,Y as c,F as v,V as p,X as d,I as h,Z as y,n as m}from"./vendor-DnaV-8Px.js";import{S as f}from"./SectionTitle-26z0N2VR.js";import{_ as g,d as x}from"./index-PnzdIyj9.js";import{g as b}from"./naive-ui-BvV26VBd.js";/* empty css                                                                     */const I={class:"section-block group-photo-section"},w={class:"section-description text-primary"},k=["innerHTML"],M={class:"content-wrap"},P={key:0,class:"photo-gallery"},A={key:0,class:"photo-text"},j={class:"photo-wrapper card-base card-hover-lift"},G={class:"photo-info text-muted"},_={key:0,class:"photo-meta"},H={key:0},S={key:1},Z={key:1,class:"album-section"},L={class:"album-title title-primary text-accent"},W=["onClick"],Y=["alt"],C={key:0,class:"history-section"},D={class:"history-gallery"},R=["onClick"],T=["alt"],B={class:"history-photo-year"},Q="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAwIiBoZWlnaHQ9IjQwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjBmMGYwIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJtb25vc3BhY2UiIGZvbnQtc2l6ZT0iMTgiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiNjY2MiPkxvYWRpbmcuLi48L3RleHQ+PC9zdmc+",z=g({__name:"GroupPhoto",setup(g){const z=a(null),E=a([]),J=a({}),N=a([]),U=a(""),F=a(""),V=a(!1),$=a(""),K=a(""),O=a(""),X=a(""),q=a(null);function aa(a){return"string"==typeof a?{url:a}:a}function ta(){oa()}function ea(){oa()}function oa(){const a=q.value;if(!a)return;const t=Array.from(a.children);if(!t.length)return;const e=a.clientWidth;let o=Math.max(1,Math.floor((e+14)/264));992>e||(o=Math.max(o,3));const l=Math.floor((e-14*(o-1))/o),s=Array(o).fill(0);a.style.position="relative",t.forEach(a=>{a.style.position="absolute",a.style.width=l+"px";const t=s.indexOf(Math.min(...s)),e=t*(l+14),o=s[t];a.style.transform=`translate(${e}px, ${o}px)`,a.style.top="0",a.style.left="0",s[t]+=a.offsetHeight+14});const r=Math.max(...s)-14;a.style.height=(r>0?r:0)+"px"}return t(()=>{!async function(){var a,t,e,o,l,s;const r=await x.getData("/msei_website/data/group-photo-content.json");F.value=r.description||"";const i=(r.history||[]).filter(a=>a.url),n=i.length?Math.max(...i.map(a=>parseInt(a.year,10)||0))+"":"";U.value=n||(new Date).getFullYear().toString(),E.value=i;const u={};Array.isArray(r.albums)&&r.albums.forEach(a=>{u[a.year]={cover:a.url||a.cover||"",date:a.date,location:a.location,photos:a.photos||[]}}),i.forEach(a=>{u[a.year]||(u[a.year]={cover:a.url,date:a.date,location:a.location,photos:a.photos||[]})});const c=r.currentYearPhotos||r.currentPhotos||(null==(a=r.main)?void 0:a.photos)||[];if(c&&c.length){u[U.value]=u[U.value]||{cover:null==(t=r.main)?void 0:t.url,date:null==(e=r.main)?void 0:e.date,location:null==(o=r.main)?void 0:o.location,photos:[]};const a=[...Array.isArray(u[U.value].photos)?u[U.value].photos:[],...c];u[U.value].photos=Array.from(new Set(a))}J.value=u;const v=i.find(a=>a.year===U.value);z.value={url:null==(l=u[U.value])?void 0:l.cover},K.value=(null==v?void 0:v.text)||"",O.value=(null==v?void 0:v.date)||"",X.value=(null==v?void 0:v.location)||"",N.value=((null==(s=u[U.value])?void 0:s.photos)||[]).map(aa)}(),window.addEventListener("resize",ea,{passive:!0})}),e(()=>{window.removeEventListener("resize",ea)}),o(N,async()=>{await m(),oa()}),(a,t)=>{const e=c("lazyload");return h(),l("section",I,[s(f,{title:"Group Photo"}),r("div",w,[r("p",{innerHTML:F.value},null,8,k)]),r("div",M,[z.value&&z.value.url?(h(),l("div",P,[K.value?(h(),l("div",A,n(K.value),1)):i("",!0),r("div",j,[u((h(),l("img",{key:z.value.url,src:Q,alt:"Group Photo",class:"group-photo"})),[[e,z.value.url]])]),r("div",G,[O.value||X.value?(h(),l("div",_,[O.value?(h(),l("span",H,"Date： "+n(O.value),1)):i("",!0),X.value?(h(),l("span",S,"Location： "+n(X.value),1)):i("",!0)])):i("",!0)])])):i("",!0),N.value&&N.value.length>0?(h(),l("div",Z,[r("div",L,n(U.value)+" Album",1),r("div",{class:"masonry-wall",ref_key:"masonryWallRef",ref:q},[(h(!0),l(v,null,p(N.value,(a,t)=>(h(),l("div",{key:a.url||a,class:"masonry-item card-base card-hover-lift",onClick:t=>function(a){const t=a.url||a;$.value=t,V.value=!0}(a)},[u(r("img",{src:Q,alt:"Album photo "+(t+1),class:"masonry-img",onLoad:ta},null,40,Y),[[e,a.url||a]])],8,W))),128))],512)])):i("",!0)]),s(d(b)),E.value.length?(h(),l("div",C,[t[0]||(t[0]=r("div",{class:"history-title title-primary text-accent"},"Group Photos by Year",-1)),r("div",D,[(h(!0),l(v,null,p(E.value,a=>(h(),l("div",{key:a.year,class:"history-photo-wrapper card-base card-hover-lift",onClick:y(t=>function(a){var t;U.value=a.year,z.value={url:a.url},K.value=a.text||"",O.value=a.date||"",X.value=a.location||"",N.value=((null==(t=J.value[a.year])?void 0:t.photos)||[]).map(aa),m(()=>{oa()})}(a),["stop"])},[u(r("img",{src:Q,alt:"Group Photo "+a.year,class:"history-photo"},null,8,T),[[e,a.url]]),r("div",B,n(a.year),1)],8,R))),128))])])):i("",!0)])}}},[["__scopeId","data-v-528fe8cc"]]);export{z as default};
